========================================
物联网卡管理系统 - 完整启动测试指南
========================================

【当前完成状态】
✅ 后端所有接口正常
✅ 数据库已初始化，有测试数据
✅ Admin前端所有页面已补全
✅ API调用已修复
⏳ 需要测试功能完整性

========================================

【启动步骤】

## 1. 启动后端 (端口 8080)
cd ~/workspace/backend
go run cmd/server/main.go

看到输出：
- 数据库连接成功
- 服务器启动在端口 8080

## 2. 启动Admin管理端 (端口 3001)
cd ~/workspace/frontend/admin
npm run dev -- --host 0.0.0.0 --port 3001 --strictPort

看到输出：
- Local:   http://localhost:3001/
- Network: http://192.168.0.128:3001/

## 3. 启动H5用户端 (端口 3000)
cd ~/workspace/frontend/h5
npm run dev -- --host 0.0.0.0 --port 3000 --strictPort

看到输出：
- Local:   http://localhost:3000/
- Network: http://192.168.0.128:3000/

========================================

【访问地址】

Admin管理端: http://192.168.0.128:3001
- 账号: admin
- 密码: admin123

H5用户端: http://192.168.0.128:3000
- 测试卡号: 89860123456789012345
- 测试设备号: 866123456789012

========================================

【功能测试清单】

## Admin管理端测试

1. 登录功能
   - 访问: http://192.168.0.128:3001
   - 输入账号密码登录
   - ✅ 成功跳转到首页

2. 首页Dashboard
   - 查看统计数据
   - ✅ 显示: 卡片总数、充值总金额等

3. 卡片管理
   - 查看卡片列表
   - 搜索卡片（按卡号/设备号）
   - 按状态筛选（正常/即将到期/已过期）
   - 添加新卡片
   - 编辑卡片信息
   - 删除卡片
   - 分页功能

4. 充值记录
   - 查看充值记录列表
   - 搜索记录（卡号/设备号/订单号）
   - 按支付状态筛选
   - 按日期范围筛选
   - 查看总充值金额
   - 分页功能

5. 系统配置
   - 查看当前配置
   - 修改充值价格
   - 修改到期提醒天数
   - 配置微信支付参数
   - 保存配置

## H5用户端测试

1. 查询页面
   - 输入卡号: 89860123456789012345
   - 点击查询
   - ✅ 显示卡片信息（卡号、设备号、到期日期、状态）

2. 充值页面（模拟）
   - 从查询结果点击"充值"
   - 显示充值信息
   - 生成订单（模拟支付）

========================================

【API接口测试】

后端所有接口已验证通过：

1. H5接口
   ✅ GET  /api/v1/card/query?keyword=卡号
   ✅ POST /api/v1/payment/create
   ✅ GET  /api/v1/payment/status?trade_no=订单号

2. 管理端接口
   ✅ POST /api/v1/admin/login
   ✅ GET  /api/v1/admin/statistics
   ✅ GET  /api/v1/admin/cards
   ✅ POST /api/v1/admin/cards
   ✅ PUT  /api/v1/admin/cards/:id
   ✅ DELETE /api/v1/admin/cards/:id
   ✅ GET  /api/v1/admin/recharges
   ✅ GET  /api/v1/admin/config
   ✅ POST /api/v1/admin/config

========================================

【测试数据】

数据库中已有以下测试数据：

1. 管理员账号
   - 用户名: admin
   - 密码: admin123

2. 测试卡片（5张）
   - 正常: 89860123456789012345 / 866123456789012
   - 即将到期: 89860123456789012346 / 866123456789013
   - 已过期: 89860123456789012347 / 866123456789014
   - 正常: 89860123456789012348 / 866123456789015
   - 正常: 89860123456789012349 / 866123456789016

3. 充值记录（2条）
   - 卡号12345和12346各有1条已支付记录

========================================

【常见问题】

Q1: 页面刷新就报"请求失败"
A: 检查后端是否在运行（端口8080）
   检查浏览器Network显示的具体错误

Q2: 登录后跳转到空白页
A: 清除浏览器localStorage
   重新登录

Q3: 前端启动报esbuild错误
A: 删除node_modules重装：
   cd frontend/admin
   rm -rf node_modules package-lock.json
   npm install

Q4: H5查询返回404
A: 检查测试数据是否插入成功：
   psql -h 127.0.0.1 -U iot_user -d iot_card_db
   SELECT * FROM sim_cards;

========================================

【下一步】

如果所有功能测试通过，可以：
1. 配置真实的微信支付参数
2. 部署到生产环境
3. 配置Nginx反向代理
4. 配置HTTPS证书
5. 设置定时任务（到期提醒等）

========================================
